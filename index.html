<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://fonts.cdnfonts.com/css/atkinson-hyperlegible"
      rel="stylesheet"
    />
    <!-- Bootstrap -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <title>Carbon Footprint Calculator</title>
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <h1>Carbon Footprint Estimator</h1>
    <button class="button" onclick="fillTestData()">Fill Test Data</button>
    <!-- Transport -->
     <nav class="navbar navbar-inverse visible-xs">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>                        
          </button>
          <a class="navbar-brand" href="#">Logo</a>
        </div>
        <div class="collapse navbar-collapse" id="myNavbar">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Dashboard</a></li>
            <li><a href="#">Age</a></li>
            <li><a href="#">Gender</a></li>
            <li><a href="#">Geo</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="inline-field">
      <h2>Transportation</h2>
      <p>Time length:</p>
      <select id="transport_timeframe" onchange="updateTimeframe(this)">
        <option value="weekly">Weekly</option>
        <option value="monthly">Monthly</option>
        <option value="yearly">Yearly</option>
      </select>
    </div>
    <div style="margin-top: 0.5em; text-align: center">
      <button type="button" class="button" onclick="addTransportEntry()">
        Add mode of transport
      </button>
    </div>
    <div id="transportEntriesContainer"></div>

    <!-- Diet(s) -->
    <div class="inline-field">
      <h2>Diet</h2>
    </div>
    <button type="button" class="button" onclick="addDietEntry()">Add Diet</button>
    <div id="dietEntriesContainer"></div>

    <!-- Food Waste -->
    <div class="inline-field">
      <h2>Food Waste</h2>
      <p>Time length:</p>
      <select id="foodwaste_timeframe" onchange="updateTimeframe(this)">
        <option value="weekly">Weekly</option>
        <option value="monthly">Monthly</option>
        <option value="yearly">Yearly</option>
      </select>
    </div>
    <p>How many kg of food waste do you throw away from your household?</p>
    <div class="inline-field">
      <label for="bread">Bread:</label>
      <input type="number" id="trash-bread-h" />
      <label for="produce">Produce:</label>
      <input type="number" id="trash-produce-h" />
      <label for="meat">Meat:</label>
      <input type="number" id="trash-meat-h" />
    </div>
    <div class="inline-field">
    </div>
    <p>How many kg of food waste do you compost from your household?</p>
    <div class="inline-field">
      <label for="bread">Bread:</label>
      <input type="number" id="compost-bread-h" />
      <label for="produce">Produce:</label>
      <input type="number" id="compost-produce-h" />
      <label for="meat">Meat:</label>
      <input type="number" id="compost-meat-h" />
    </div>
    <p>How many kg of food waste do you compost from outside your household?</p>
    <div class="inline-field">
      <label for="bread">Bread:</label>
      <input type="number" id="trash-bread-oh" />
      <label for="produce">Produce:</label>
      <input type="number" id="trash-produce-oh" />
      <label for="meat">Meat:</label>
      <input type="number" id="trash-meat-oh" />
    </div>

    <!-- Utilities -->
    <div class="inline-field">
      <h2>Utilities</h2>
      <p>Time length:</p>
      <select id="utilities_timeframe" onchange="updateTimeframe(this)">
        <option value="weekly">Weekly</option>
        <option value="monthly" selected>Monthly</option>
        <option value="yearly">Yearly</option>
      </select>
    </div>
    <label for="electricity"
      >How many kW do you use per
      <span class="timeframe" data-for="utilities_timeframe"></span>?
      <input
        type="number"
        id="electricity"
        style="display: inline-block; width: auto; margin-left: 0.5em"
      />
    </label>
    <label for="gas"
      >How many m<sup>3</sup> of natural gas do you use per
      <span class="timeframe" data-for="utilities_timeframe"></span>?
      <input
        type="number"
        id="gas"
        style="display: inline-block; width: auto; margin-left: 0.5em"
      />
    </label>
    <label for="water"
      >How many liters of water do you use per
      <span class="timeframe" data-for="utilities_timeframe"></span>?
      <input
        type="number"
        id="water"
        style="display: inline-block; width: auto; margin-left: 0.5em"
      />
    <label for="water"
      >Can you plz search on the internet for "kWh for 1 m^3 of water near me"? It's very local.
      <span class="timeframe" data-for="utilities_timeframe"></span>?
      <input
        type="number"
        id="waterEI"
        style="display: inline-block; width: auto; margin-left: 0.5em"
      />
    </label>
    <div class="inline-field">
      <p>Where do you get your utilities from?</p>
      <label for="country">Country:</label>
      <select id="country" onchange="updateRegions()">
        <option value="">-- Select Country --</option>
        <option value="USA">United States</option>
        <option value="CAN">Canada</option>
        <option value="MEX">Mexico</option>
        <option value="TAI">Taiwan</option>
        <option value="NET">Netherlands</option>
      </select>
      <label for="region">Region:</label>
      <select id="region">
        <option value="">-- Select Region --</option>
      </select>
    </div>

    <button class="button" onclick="calcFootprint()">
      Calculate Footprint
    </button>

    <div id="result"></div>
    <iframe 
        src="https://www.pik-potsdam.de/Carbonclock/Carbonclock.htm" 
        style="width: 600px; height: 340px; border: none;" 
        title="Carbon Clock by PIK Potsdam">
    </iframe>
    <p>If I can share anything with you, it is this: we can eliminate most of the sectors of all of our footprints through straightforward lifestyle choices (personal responsibility), collective action through activism, research and governmental policies. All it takes is for a large enough proportion of each country's population to care enough about human impact on the climate and biosphere that all our governments decide to change things.</p>
    <p>"No one is too small to make a difference" - Greta Thunburg</p>
    <p>Made by Jack Conneely.</p>
    <p>Source code: <a href="https://github.com/electricwapiti/Carbon-footprint-calculator">GitHub</a>"
    <p>Data sources: <a href="https://www.pik-potsdam.de/carbonclock">PIK Potsdam Carbon Clock</a></p>
    
    <script>
      // Transport entries management.
      let transportEntries = [];
      let nextTransportId = 0;
      function addTransportEntry() {
        const container = document.getElementById("transportEntriesContainer");
        const id = nextTransportId++;

        // Default entry object
        const entry = {
          id,
          mode: "car",
          distance: 0,
          fuelEfficiency: 0,
        };
        transportEntries.push(entry);

        const entryDiv = document.createElement("div");
        entryDiv.className = "transport-entry";
        entryDiv.id = `transport-${id}`;
        entryDiv.innerHTML = `
            <div class="transport-row">
              <label>
                  <select onchange="updateTransportMode(${id}, this.value)">
                      <option value="car">Car</option>
                      <option value="bus">Bus</option>
                      <option value="train">Train</option>
                      <option value="bike">Bicycle</option>
                      <option value="walk">Walking</option>
                  </select>
              </label>

              <label>
                  km last
                  <span class="timeframe" id="timeframe-${id}" data-for="transport_timeframe"></span>:
                  <input type="number" onchange="updateTransportDistance(${id}, this.value)">
              </label>

              <label id="fuel-eff-${id}">Fuel Efficiency (L/100km):
                  <input type="number" onchange="updateTransportFuel(${id}, this.value)">
              </label>

              <button type="button" class="button delete-button" onclick="removeTransportEntry(${id})">X</button>
            </div>
        `;
        container.appendChild(entryDiv);

        //Set the correct time length text for new entries
        const timeframeValue = document.getElementById(
          "transport_timeframe"
        ).value;
        let text = "week";
        if (timeframeValue === "monthly") text = "month";
        else if (timeframeValue === "yearly") text = "year";
        document.getElementById(`timeframe-${id}`).textContent = text;
      }

      //Keep your array in sync with the UI
      function updateTransportMode(id, mode) {
        const entry = transportEntries.find((e) => e.id === id);
        if (entry) entry.mode = mode;

        const fuelLabel = document.getElementById(`fuel-eff-${id}`);
        fuelLabel.style.display = mode === "car" ? "inline-block" : "none";
      }

      function updateTransportDistance(id, value) {
        const entry = transportEntries.find((e) => e.id === id);
        if (entry) entry.distance = parseFloat(value) || 0;
      }

      function updateTransportFuel(id, value) {
        const entry = transportEntries.find((e) => e.id === id);
        if (entry) entry.fuelEfficiency = parseFloat(value) || 0;
      }

      function removeTransportEntry(id) {
        transportEntries = transportEntries.filter((e) => e.id !== id);
        const entryDiv = document.getElementById(`transport-${id}`);
        if (entryDiv) entryDiv.remove();
      }

      function updateTransportInputs() {
        const transportType = document.getElementById("transportType").value;
        const carInputs = document.getElementById("carInputs");
        if (transportType === "car") {
          carInputs.style.display = "block";
        } else {
          carInputs.style.display = "none";
        }
      }

      // Diet entries management.
      // TODO: Treat diet entries as an array of objects including type, calories, and id. 
      // Use this to sum up the emissions of an entire household.
      let dietEntries = [];
      let dietIdCounter = 0;
      function addDietEntry() {
        
        //wire the select, input and delete buttons to the correct functions
        //timeframe is updated by select element
        
        // Create a new default diet entry in the array
        const container = document.getElementById("dietEntriesContainer");
        const id = dietIdCounter++;
        const entry = {
          id,
          type: "average",
          name: "",
          calories: 0,
        };
        dietEntries.push(entry);

        // Create a new diet entry in the UI with a div
        const entryDiv = document.createElement("div");
        entryDiv.className = "diet-entry";
        entryDiv.id = `diet-${id}`;
        entryDiv.innerHTML = `
        <div class="diet-row">
          <label>Name:
            <input type="text" placeholder="Name" onchange="updateDietName(${id}, this.value)">
            </label>
              <label>Diet:
                <select onchange="updateDietType(${id}, this.value)">
                  <option value="high_meat">High Meat Eater</option>
                  <option value="average" selected>Average</option>
                  <option value="pescitarian_w_s">Pescitarian w/ shrimp</option>
                  <option value="pescitarian_wo_s">Pescitarian w/o shrimp</option>
                  <option value="vegetarian">Vegetarian</option>
                  <option value="vegan">Vegan</option>
                </select>
              </label>

                <label>
                  Calories/day (kcal):
                  <input type="number" onchange="updateDietCalories(${id}, this.value)">
                </label>

              <button type="button" class="button delete-button" onclick="removeDietEntry(${id})">X</button>
        </div>
        `;
        container.appendChild(entryDiv);
      }

      function updateDietType(id, value) {
        const entry = dietEntries.find(e => e.id === id);
        if (entry) {
          entry.type = value;
        }
      }

      function updateDietName(id, value) {
        const entry = dietEntries.find(e => e.id === id);
        if (entry) {
          entry.name = value;
        }
      }

      function updateDietCalories(id, value) {
        const entry = dietEntries.find(e => e.id === id);
        if (entry) {
          entry.calories = parseFloat(value) || 0;
        }
      }
      
      function removeDietEntry(id) {
        const el = document.getElementById(`diet-${id}`);
        if (el) el.remove();
      }

      // Keep all the timeframe text in sync with the selected option
      function updateTimeframe(selectElement) {
        const value = selectElement.value;
        let text = "week";
        if (value === "monthly") text = "month";
        else if (value === "yearly") text = "year";
        const relatedSpan = document
          .querySelectorAll(`.timeframe[data-for="${selectElement.id}"]`)
          .forEach((span) => {
            span.textContent = text;
          });
      }

      function calcDiet() {
        // Timeframe is 1 day in the UI & 1 wk in the default emissions map.
        const dietEmissionsMap = {
          high_meat: 40,
          average: 25,
          pescitarian_w_s: 22,
          pescitarian_wo_s: 18,
          vegetarian: 15,
          vegan: 12,
        };
        
        // Calculate and sum the total CO2e emissions for each diet entry.
        let dietCO2e = 0;
        for (const entry of dietEntries) {
          const dietType = entry.type;
          const calories = entry.calories || 0;
          const dietEmissions = dietEmissionsMap[dietType] || 0;
          const yearlyEmissions = convertToYearly("weekly", dietEmissions);
          dietCO2e += (yearlyEmissions * calories) / 2000;
        }
        return dietCO2e;
      }

      function calcTransit() {
        const timeframe = document.getElementById("transport_timeframe").value;

        // Emissions factors in kg CO2e per km
        const emissionsPerKm = {
          bus: 0.105,
          train: 0.041,
          bike: 0,
          walk: 0,
        };

        let transportCO2e = 0;

        for (const entry of transportEntries) {
          const km = entry.distance || 0;
          if (entry.mode === "car") {
            const litersUsed = (km / 100) * (entry.fuelEfficiency || 0);
            transportCO2e += litersUsed * 2.31;
          } else {
            transportCO2e += (emissionsPerKm[entry.mode] || 0) * km;
          }
        }

        transportCO2e = convertToYearly(timeframe, transportCO2e);
        return transportCO2e;
      }

      function calcFoodWaste() {
        // Collect the values from user input
        const breadTrash = parseFloat(document.getElementById("trash-bread-h").value) || 0;
        const produceTrash = parseFloat(document.getElementById("trash-produce-h").value) || 0;
        const meatTrash = parseFloat(document.getElementById("trash-meat-h").value) || 0;
        const breadCompost = parseFloat(document.getElementById("compost-bread-h").value) || 0;
        const produceCompost = parseFloat(document.getElementById("compost-produce-h").value) || 0;
        const meatCompost = parseFloat(document.getElementById("compost-meat-h").value) || 0;

        // Anaerobic decomposition of food waste:
        const CH4_PRODUCE = 0.25;
        const CH4_BREAD = 0.375;
        const CH4_MEAT = 0.7;

        // Aerobic decomposition of food waste:
        const CO2_FOODWASTE = 0.06; // kg CO2 emitted per kg of food waste

        // CO2e emissions from food waste trash
        const ESCAPE_FACTOR = 0.61; // 61% of landfilled methane escapes to atmosphere
        const GWP_100yr = 28;
        const trashCO2e = (breadTrash * CH4_BREAD + produceTrash * CH4_PRODUCE + meatTrash * CH4_MEAT) * ESCAPE_FACTOR * GWP_100yr;
        
        // CO2e emissions from food waste compost
        const propAnaerobic = 0.03;
        const carbonStorage = 0.1; //kg CO2e of compost applied per kg of food waste composted (compost is half of the mass of food waste)
        const compost_CH4_CO2e = (breadCompost * CH4_BREAD + produceCompost * CH4_PRODUCE + meatCompost * CH4_MEAT) * GWP_100yr * ESCAPE_FACTOR * propAnaerobic;
        const compostCO2e = (breadCompost + produceCompost + meatCompost) * (CO2_FOODWASTE - carbonStorage) + compost_CH4_CO2e;
        const foodwasteCO2e = trashCO2e + compostCO2e;
        return foodwasteCO2e;
      }

      // Calculate the CO2e emissions avoided by composting food waste from outside the household.
      // This is a societal emission reduction opportunity. TODO: add more opportunities (e.g. activism, lobbying, voting, donating, etc.) if you think of any.
      function calcCompostAvoided() {
        const breadCompostOH = parseFloat(document.getElementById("trash-bread-oh").value) || 0;
        const produceCompostOH = parseFloat(document.getElementById("trash-produce-oh").value) || 0;
        const meatCompostOH = parseFloat(document.getElementById("trash-meat-oh").value) || 0;

        // Landfill anaerobic decomposition of food waste
        const CH4_BREAD = 0.375;
        const CH4_PRODUCE = 0.25;
        const CH4_MEAT = 0.7;
        const ESCAPE_FACTOR = 0.61; // 61% escapes
        const GWP_100yr = 28;

        // CO2e emissions from food waste compost
        const CO2_FOODWASTE = 0.06; // kg CO2 emitted per kg of food waste composted
        const propAnaerobic = 0.03;
        const carbonStorage = 0.1; //kg CO2e of compost applied per kg of food waste composted (compost is half of the mass of food waste)
        const compost_CH4_CO2e = (breadCompostOH * CH4_BREAD + produceCompostOH * CH4_PRODUCE + meatCompostOH * CH4_MEAT) * GWP_100yr * ESCAPE_FACTOR * propAnaerobic;
        const compostCO2e = (breadCompostOH + produceCompostOH + meatCompostOH) * (CO2_FOODWASTE - carbonStorage) + compost_CH4_CO2e;
        
        // CO2e emissions from diversion from landfill
        const noTrashCO2e = - (breadCompostOH * CH4_BREAD + produceCompostOH * CH4_PRODUCE + meatCompostOH * CH4_MEAT) * ESCAPE_FACTOR * GWP_100yr;

        // total CO2e avoided per user-specified timeframe via extra composting
        const avoidedCO2e = noTrashCO2e + compostCO2e;

        // Convert avoided CO2e to yearly CO2e
        const foodwasteTimeframe = document.getElementById("foodwaste_timeframe").value;
        const yearlyAvoidedCO2e = convertToYearly(foodwasteTimeframe, avoidedCO2e);
        console.log("the food waste avoided yearly emissions is" + yearlyAvoidedCO2e);
        return yearlyAvoidedCO2e;
      }

      function calcUtilities() {
        //get the values from the inputs
        //get the location selected for sources
        //read the specific region's CO2e intensity for each utility type from the JSON file
        //convert the input into kg CO2e
        //add & return the total emissions
        
        //get the values from the inputs
        const timeframe = document.getElementById("utilities_timeframe").value;
        const kWh = parseFloat(document.getElementById("electricity").value) || 0;
        const m3Gas = parseFloat(document.getElementById("gas").value) || 0;
        const litersWater = parseFloat(document.getElementById("water").value) || 0;

        // Get country and region from the DOM
        const country = document.getElementById("country").value;
        const region = document.getElementById("region").value;

        //Convert inputs to yearly emissions
        const yearlykWh = convertToYearly(timeframe, kWh);
        const yearlyGas = convertToYearly(timeframe, m3Gas);
        const yearlyWater = convertToYearly(timeframe, litersWater);
        console.log(
          `Yearly kWh: ${yearlykWh}, Yearly Gas: ${yearlyGas}, Yearly Water: ${yearlyWater}`
        );
        //Get region's electricity, gas, and water CO2e intensities
        const regionInfo = regionData[country]?.regions?.[region];
        const electricityIntensity = regionInfo.gCO2e_kWh * 0.001;
        const electricityCO2e = yearlykWh * electricityIntensity;
        //TODO:Find gas and water intensities, put em in the JSON file 

        //Calculate water emissions: 
        // CO2e intensity for H2O = H2O energy intensity * electricity carbon intensity + 30 g/m^3 (additives)
        const yearlyM3Water = yearlyWater * 0.001;
        //I had to ask for user input as its highly local :( 
        // TODO: compile a list of water EI values for different regions
        const waterEI = parseFloat(document.getElementById("waterEI").value) || 0; 
        const waterCO2e = yearlyM3Water * (waterEI * electricityIntensity + 0.03);


        //const gasIntensity = regionData[country].regions[region].gas;
        //const waterIntensity = regionData[country].regions[region].water;
        //For now, use placeholder values of "0.5" for gas and "0.1" for water
        const gasIntensity = 0.5; // kg CO2e per m3
        const waterIntensity = 0.1; // kg CO2e per liter
        const gasCO2e = yearlyGas * gasIntensity; //TODO: THIS IS A PLACEHOLDER VALUE, DO NOT USE IT IN PRODUCTION


        const totalUtilityCO2e = electricityCO2e + waterCO2e + gasCO2e;
        return totalUtilityCO2e;
      }
      /**
       * Convert the input value to yearly emissions based on the selected timeframe.
       * @param {string} timeframeElement - The selected timeframe (weekly, monthly, yearly).
       * @param {number} inputValue - The input value to convert.
       * @return {number} - The converted yearly emissions value.
       */
      function convertToYearly(timeframeElement, inputValue) {
        let yearlyEmissions = inputValue;
        if (timeframeElement === "weekly") {
          yearlyEmissions *= 52;
        } else if (timeframeElement === "monthly") {
          yearlyEmissions *= 12;
        }
        return yearlyEmissions;
      }

      function updateFoodFootprint() {
        const diet = document.getElementById("diet").value;
        let emissions = 0;
        switch (diet) {
          //TODO: do research about actual values
          case "high_meat":
            emissions = 40; //kg C02e per week
            break;
          case "average":
            emissions = 25; //kg C02e per week
            break;
          case "pescitarian_w_shrimp":
            emissions = 22; //kg C02e per week
            break;
          case "pescitarian_wo_shrimp":
            emissions = 18; //kg C02e per week
            break;
          case "vegetarian":
            emissions = 15; //kg C02e per week
            break;
          case "vegan":
            emissions = 12; //kg C02e per week
            break;
        }
      }

      /** CalcFootprint is the main fxn for calculating the footprint.
       *  It runs when the user presses the main calc footprint button.
       *  It calls other fxns for each sector before calling another fxn to output the data.
       * params: none
       * returns: none
       **/
      function calcFootprint() {
        //Verify that the user set enough data to calculate a footprint
        if (
          transportEntries.length === 0 ||
          dietEntries.length === 0 ||
          document.getElementById("utilities_timeframe").value === "" ||
          document.getElementById("country").value === "" ||
          document.getElementById("region").value === ""
        ) {
          alert("Please fill in all required fields.");
          return;
        }

        transportCO2e = calcTransit();
        dietCO2e = calcDiet();
        // Water CO2e/L
        // Electricity CO2e/kWh
        // Gas CO2e/m3
        
        utilitiesCO2e = calcUtilities();
        console.log("Utilities CO2e: " + utilitiesCO2e);
        foodwasteCO2e = calcFoodWaste();
        compostAvoidedCO2e = calcCompostAvoided();

        const totalEmissions =
          transportCO2e +
          utilitiesCO2e +
          dietCO2e +
          foodwasteCO2e +
          compostAvoidedCO2e;
        document.getElementById("result").innerHTML = `
            <section class="result-section">
                Emissions from transportation: <span class="calc-value">${transportCO2e.toFixed(
                  2
                )} kg CO₂e</span><br/>
                Emissions from utilities: <span class="calc-value">${utilitiesCO2e.toFixed(
                  2
                )} kg CO₂e</span><br/>
                Emissions from food waste: <span class="calc-value">${foodwasteCO2e.toFixed(
                  2
                )} kg CO₂e</span><br/>
                Emissions from extra composting: <span class="calc-value">${compostAvoidedCO2e.toFixed(
                  2
                )} kg CO₂e</span><br/>
                Emissions from diet: <span class="calc-value">${dietCO2e.toFixed(
                  2
                )} kg CO₂e</span><br/>
                <hr>
                <strong>Total carbon footprint: <span class="calc-value">${totalEmissions.toFixed(
                  2
                )} kg CO₂e</span></strong>
            </section>
        `;
      }
      function getRegionData() {
        // TODO: Implement a function to fetch and return region data
      }
      //Load & manage region CO2e emissions for utilities
      let regionData = {};

      window.addEventListener("DOMContentLoaded", () => {
        fetch("./intensities.json")
          .then((response) => response.json())
          .then((data) => {
            regionData = data.countries;
          })
          .catch(error => console.log("Error loading the JSON:", error))
      });

      function updateRegions() {
        const countrySelect = document.getElementById("country");
        const regionSelect = document.getElementById("region");
        const selectedCountry = countrySelect.value;
        regionSelect.innerHTML = "";
        // Add each region to the dropdown
        const regions = regionData[selectedCountry].regions;
        Object.keys(regions).forEach(region => {
            const option = document.createElement("option");
            option.value = region;
            option.textContent = region;
            regionSelect.appendChild(option);
        });
      }

      // Fill test data
      function fillTestData() {
      // Transport
      transportEntries = [];
      document.getElementById("transportEntriesContainer").innerHTML = "";
      addTransportEntry();
      const entry = transportEntries[0];
      updateTransportMode(entry.id, "car");
      updateTransportDistance(entry.id, 100);
      updateTransportFuel(entry.id, 10);
      document.querySelector(`#transport-${entry.id} input[type="number"]`).value = 100;
      document.querySelector(`#fuel-eff-${entry.id} input[type="number"]`).value = 10;

      // Diet
      dietEntries = [];
      document.getElementById("dietEntriesContainer").innerHTML = "";
      addDietEntry();
      const dietEntry = dietEntries[0];
      updateDietName(dietEntry.id, "U. N. Owen");
      updateDietType(dietEntry.id, "high_meat");
      updateDietCalories(dietEntry.id, 3900);
      document.querySelector(`#diet-${dietEntry.id} input[type="text"]`).value = "U. N. Owen";
      document.querySelector(`#diet-${dietEntry.id} select`).value = "high_meat";
      document.querySelector(`#diet-${dietEntry.id} input[type="number"]`).value = 3900;

      // Food Waste
      document.getElementById("trash-bread-h").value = 3;
      document.getElementById("trash-produce-h").value = 1;
      document.getElementById("trash-meat-h").value = 5;
      document.getElementById("compost-bread-h").value = 0;
      document.getElementById("compost-produce-h").value = 0;
      document.getElementById("compost-meat-h").value = 0;
      document.getElementById("trash-bread-oh").value = 0;
      document.getElementById("trash-produce-oh").value = 0;
      document.getElementById("trash-meat-oh").value = 0;

      // Utilities
      document.getElementById("utilities_timeframe").value = "monthly";
      updateTimeframe(document.getElementById("utilities_timeframe"));

      document.getElementById("electricity").value = 3000;
      document.getElementById("gas").value = 3;
      document.getElementById("water").value = 3000;
      document.getElementById("waterEI").value = 1;

      // Country and Region
      document.getElementById("country").value = "USA";
      updateRegions();

      // Delay region selection slightly to allow updateRegions() to populate the list
      setTimeout(() => {
        const regionSelect = document.getElementById("region");
        if (regionSelect.options.length > 1) {
          regionSelect.selectedIndex = 1; // Select the first actual region
        }
      }, 100); // May need to adjust this depending on region data load time
    }
    </script>
  </body>
</html>
